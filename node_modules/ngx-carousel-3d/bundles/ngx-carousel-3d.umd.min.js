!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs/BehaviorSubject"),require("@angular/core"),require("jquery"),require("rxjs/Observable"),require("rxjs/add/observable/timer"),require("@angular/common")):"function"==typeof define&&define.amd?define(["exports","rxjs/BehaviorSubject","@angular/core","jquery","rxjs/Observable","rxjs/add/observable/timer","@angular/common"],e):e(t["ngx-carousel-3d"]={},t.Rx,t.ng.core,t.jqueryProxy__default__default,t.Rx,t.Rx.Observable,t.ng.common)}(this,function(t,e,r,i,o,n,s){"use strict";var a=i["default"],l=function(){var t=this;this.promise=new Promise(function(e,r){t.resolve=e,t.reject=r})},d=function(){function t(t,r){this.slides=t||[],this.leftSlides=[],this.rightSlides=[],this.leftOutSlide="",this.rightOutSlide="",this.loadCount=0,this.errorCount=0,this.states={PENDING:1,LOADING:2,RESOLVED:3,REJECTED:4},this.total=t.length,this.currentIndex=0,this.lock=!1,this.loop=r.loop||!1,this.clicking=r.clicking||!1,this.sourceProp=r.sourceProp||"",this.visible=r.visible||5,this.perspective=r.perspective||35,this.animationSpeed=r.animationSpeed||500,this.dir=r.dir||"ltr",this.width=r.width||360,this.height=r.height||270,this.border=r.border||0,this.space=r.space||"auto",this.topSpace=r.topSpace||"auto",this.controls=r.controls||!1,this.startSlide=r.startSlide||0,this.inverseScaling=r.inverseScaling||300,this.autoRotationSpeed=r.autoRotationSpeed||0,this.state=this.states.PENDING,this.deferred=new l,this.promise=this.deferred.promise,this.percent=new e.BehaviorSubject(new Object),this.imageLocation=new e.BehaviorSubject(new Object)}return t.prototype.build=function(t,e){var r=this;return r.load().promise.then(function(){r.visible=r.visible>r.total?r.total:r.visible,r.currentIndex=r.startSlide>r.total-1?r.total-1:e.startSlide;try{2!==r.visible&&(r.visible=r.visible%2?r.visible:r.visible-1)}catch(t){console.log(t)}return r},function(t){return r})},t.prototype.isInitiated=function(){return this.state!==this.states.PENDING},t.prototype.isRejected=function(){return this.state===this.states.REJECTED},t.prototype.isResolved=function(){return this.state===this.states.RESOLVED},t.prototype.load=function(){if(this.isInitiated())return this;if(this.state=this.states.LOADING,this.sourceProp)for(var t=0;t<this.total;t++)this.loadImageLocation(this.slides[t]);else this.deferred.resolve(this);return this},t.prototype.handleImageError=function(){this.errorCount++,this.isRejected()||(this.state=this.states.REJECTED,this.deferred.reject(this))},t.prototype.handleImageLoad=function(t){this.loadCount++,this.isRejected()||(this.percent.next(new Object({percent:Math.ceil(this.loadCount/this.total*100)})),this.imageLocation.next(t),this.loadCount===this.total&&(this.state=this.states.RESOLVED,this.deferred.resolve(this)))},t.prototype.loadImageLocation=function(t){var e=this,r=new Image;r.onload=function(t){e.handleImageLoad(t.target),r=t=null},r.onerror=function(t){e.handleImageError(),r=null},r.src=t[this.sourceProp]},t.prototype.getTotalNumber=function(){return this.total},t.prototype.setStartSlide=function(t){this.startSlide=t<0||t>this.total?0:t},t.prototype.setCurrentIndex=function(t){return this.currentIndex=t},t.prototype.getOuterWidth=function(){return parseInt(this.width+this.border,10)},t.prototype.getOuterHeight=function(){return parseInt(this.height+this.border,10)},t.prototype.setLock=function(t){return this.lock=t},t.prototype.getLock=function(){return this.lock},t.prototype.getSlides=function(){return this.slides},t.prototype.setSlides=function(){var t=Number(Math.floor(this.visible/2)+1),e="ltr";this.leftSlides=[],this.rightSlides=[];for(var r=1;r<t;r++){var i=this.dir===e?(this.currentIndex+r)%this.total:(this.currentIndex-r)%this.total,o=this.dir===e?(this.currentIndex-r)%this.total:(this.currentIndex+r)%this.total;this.leftSlides.push(i),this.rightSlides.push(o)}var n=this.leftOutSlide=this.currentIndex-t,s=this.rightOutSlide=this.total-this.currentIndex-t<=0?-(this.total-this.currentIndex-t):this.currentIndex+t;return this.dir===e&&(this.leftOutSlide=n,this.rightOutSlide=s),this.slides},t.prototype.getVisibleSlidesIndex=function(){for(var t=this,e={},r=this.currentIndex,i=Math.floor(this.total/2),o=0;o!==this.total;)e[i%this.total]=r,i=++i%this.total,r=++r%this.total,o++;var n=Object.keys(e).map(function(t){return e[t]});"ltr"===this.dir&&(n=n.reverse());var s=n.findIndex(function(e){return e===t.currentIndex});return n.splice(s-Math.floor(this.visible/2),this.visible)},t.prototype.isLastSlide=function(){return this.currentIndex===this.total-1},t.prototype.isFirstSlide=function(){return 0===this.currentIndex},t.prototype.getSourceProp=function(){return this.sourceProp},t.prototype.getPercent=function(){return this.percent.asObservable()},t.prototype.getImageLocation=function(){return this.imageLocation.asObservable()},t}(),c=a||i,u=function(){function t(){this.isLoading=!0,this.isSuccessful=!1,this.isRendered=!1,this.percentLoaded=0,this.autoRotation=null,this.$wrapper=null,this.$slides=[]}return t.prototype.ngOnDestroy=function(){this.percentSubscription.unsubscribe()},t.prototype.ngOnChanges=function(t){t.slides&&t.options?this.buildCarousel(t.slides.currentValue,t.options.currentValue):t.slides&&this.buildCarousel(t.slides.currentValue,this.options)},t.prototype.ngOnInit=function(){this.buildCarousel(this.slides,this.options)},t.prototype.buildCarousel=function(t,e){var r=this;return this.$carouselService=new d(this.slides,this.options),this.percentSubscription=this.$carouselService.getPercent().subscribe(function(t){r.percentLoaded=t.percent}),this.autoRotationLocked=!1,this.$carouselService.build(this.slides||[],this.options||{}).then(function(t){r.carousel3d=t,r.slides=r.carousel3d.slides,r.controls=r.carousel3d.controls,r.isLoading=!1,r.isSuccessful=!0;var e=r.carousel3d.getOuterHeight(),i=r.carousel3d.getOuterWidth();c("div.carousel-3d-container").css({height:e+"px"}),r.$wrapper=c("div.carousel-3d"),r.$wrapper.css({width:i+"px",height:e+"px"}),r.$slides=r.$wrapper.children().toArray(),new Promise(function(t,e){t(r.render(!0,r.carousel3d.animationSpeed))}).then(function(t){r.animationEnd()})},function(t){this&&(this.carousel3d=t,this.isLoading=!1,this.isSuccessful=!1),c().css({height:t.getOuterHeight()+"px"})},function(t){this.percentLoaded=t.percent})},t.prototype.render=function(t,e){var r=this;this.carousel3d.setSlides();var i=this.carousel3d.getOuterHeight(),o=this.carousel3d.getOuterWidth(),n="auto"===this.carousel3d.topSpace?0:i/2-i/2,s=this.carousel3d.width/2-o/2,a=e?e/1e3:this.carousel3d.animationSpeed/1e3,l=999;if(this.carousel3d.slides.forEach(function(e,s){var l={position:"absolute",opacity:0,visibility:"hidden",overflow:"hidden",top:n+"px","border-width":r.carousel3d.border+"px",width:o+"px",height:i+"px"};if(t){var d=Object.assign({},l,{"-webkit-transition":"all "+a+"s ","-moz-transition":"all "+a+"s ","-o-transition":"all "+a+"s ","-ms-transition":"all "+a+"s ",transition:"all "+a+"s "});r.getSlide(s).css(d)}r.getSlide(s).css(l)}),this.getSlide(this.carousel3d.currentIndex).addClass("current").css({zIndex:l,opacity:1,visibility:"visible","-webkit-transform":"none","-moz-transform":"none","-o-transform":"none","-ms-transform":"none",transform:"none",left:s+"px",top:n+"px",width:o+"px",height:i+"px"}),this.carousel3d.rightSlides.forEach(function(t,e){var i=r.setCss(e,l,!0);l-=e+1,r.getSlide(t).css(i).css({opacity:1,visibility:"visible",zIndex:l})}),this.carousel3d.leftSlides.forEach(function(t,e){var i=r.setCss(e,l,!1);l-=e+1,r.getSlide(t).css(i).css({opacity:1,visibility:"visible",zIndex:l})}),this.carousel3d.total>this.carousel3d.visible){var d=this.setCss(this.carousel3d.rightSlides.length-1,this.carousel3d.rightSlides.length-1,!0),c=this.setCss(this.carousel3d.leftSlides.length-1,this.carousel3d.leftSlides.length-1,!0);this.getSlide(this.carousel3d.rightOutSlide).css(d),this.getSlide(this.carousel3d.leftOutSlide).css(c)}return this.isRendered=!0,!0},t.prototype.setCss=function(t,e,r){var i="auto"===this.carousel3d.space?(t+1)*(this.carousel3d.width/1.5):(t+1)*this.carousel3d.space,o=r?"translateX("+i+"px) translateZ(-"+(this.carousel3d.inverseScaling+100*(t+1))+"px) rotateY(-"+this.carousel3d.perspective+"deg)":"translateX(-"+i+"px) translateZ(-"+(this.carousel3d.inverseScaling+100*(t+1))+"px) rotateY("+this.carousel3d.perspective+"deg)";return{"-webkit-transform":o,"-moz-transform":o,"-o-transform":o,"-ms-transform":o,transform:o,left:"0%",top:"auto"===this.carousel3d.topSpace?"none":(t+1)*this.carousel3d.space,width:"none",height:"none",zIndex:e,overflow:"visible"}},t.prototype.goSlide=function(t){var e=this;"function"==typeof this.onBeforeChange&&!1===this.onBeforeChange({index:this.carousel3d.currentIndex})||(this.carousel3d.setCurrentIndex(t<0||t>this.carousel3d.total-1?0:t),this.carousel3d.isLastSlide()&&"function"==typeof this.onLastSlide&&this.onLastSlide({index:this.carousel3d.currentIndex}),this.$slides.forEach(function(t,e){c().removeClass("current")}),this.carousel3d.setLock(!0),new Promise(function(t,r){t(e.render(!0,e.carousel3d.animationSpeed))}).then(function(t){e.animationEnd()}))},t.prototype.goNext=function(){return!(this.carousel3d.getLock()||!this.carousel3d.loop&&this.carousel3d.isLastSlide())&&(this.carousel3d.isLastSlide()?this.goSlide(0):this.goSlide(this.carousel3d.currentIndex+1),!0)},t.prototype.goPrev=function(){return!(this.carousel3d.getLock()||!this.carousel3d.loop&&this.carousel3d.isFirstSlide())&&(this.carousel3d.isFirstSlide()?this.goSlide(this.carousel3d.total-1):this.goSlide(this.carousel3d.currentIndex-1),!0)},t.prototype.goFar=function(t){var e=this;if(t!==this.carousel3d.currentIndex){var r=this.carousel3d.getVisibleSlidesIndex(),i=r.findIndex(function(e){return e===t});if(!(i<0)){var o=r.findIndex(function(t){return t===e.carousel3d.currentIndex});if(!(o<0)){var n=i-o;"ltr"===this.carousel3d.dir&&(n=-n);for(var s=Math.abs(n),a=0,l=this.carousel3d.animationSpeed/s,d=0;d<s;d++,a+=l)setTimeout(function(){n>=0?e.goNext():e.goPrev()},a)}}}},t.prototype.animationEnd=function(){this.carousel3d.setLock(!1),"function"==typeof this.onSlideChange&&this.onSlideChange({index:this.carousel3d.currentIndex}),this.$timer||this.subscribe()},t.prototype.getSlide=function(t){return c(t>=0?this.$slides[t]:this.$slides[this.carousel3d.total+t])},t.prototype.slideClicked=function(t){if(this.$timer&&this.$timer.unsubscribe(),this.$timer=null,this.carousel3d.currentIndex!==t){if(!this.carousel3d.clicking)return!1;this.goFar(t)}else"function"==typeof this.onSelectedClick&&this.onSelectedClick({index:this.carousel3d.currentIndex})},t.prototype.subscribe=function(){var t=this;this.$timer=o.Observable.timer(this.carousel3d.autoRotationSpeed,this.carousel3d.autoRotationSpeed).subscribe(function(){t.carousel3d.autoRotationLocked||("ltr"===t.options.dir?t.goNext():t.goPrev())})},t.prototype.setSlideLock=function(t){this.$carouselService.setLock(t),this.autoRotationLocked=t},t}();u.decorators=[{type:r.Component,args:[{selector:"ngx-carousel-3d",template:'<div class="carousel-3d-container">\n  <div class="carousel-3d-loader" [hidden]="!isLoading">\n      <div class="carousel-3d-loader-circle"></div>\n      <div class="carousel-3d-loader-percentage">{{ percentLoaded }}</div>\n  </div>\n  <div  [hidden]="isLoading" [ngSwitch]="isSuccessful" >\n      <div #carousel3D class="carousel-3d" [hidden]="!isRendered && !isSuccessful">\n          <ng-content></ng-content>\n      </div>\n      <p  [hidden]="isSuccessful"  class="carousel-3d-loader-error">There was a problem during load</p>\n      <div *ngIf="controls" class="carousel-3d-controls">\n          <div class="carousel-3d-next arrow-left" (click)="options.dir === \'ltr\' ? goNext() : goPrev()"></div>\n          <div class="carousel-3d-prev arrow-right" (click)="options.dir === \'ltr\' ? goPrev() : goNext()"></div>\n      </div>\n  </div>\n</div>',styles:[".carousel-3d-container{\n  width:100%;\n  overflow:hidden;\n  position:relative;\n  z-index:0;\n  margin:20px auto; }\n.carousel-3d{\n  position:relative;\n  margin:0 auto;\n  -webkit-transform-style:preserve-3d;\n  transform-style:preserve-3d;\n  -webkit-perspective:1000px;\n  -o-perspective:1000px;\n  -ms-perspective:1000px;\n  perspective:1000px; }\n.carousel-3d.ng-hide{\n  opacity:0; }\n.carousel-3d.ng-hide-remove{\n  -webkit-transition:opacity linear 1000ms;\n  transition:opacity linear 1000ms; }\n.carousel-3d.ng-hide-add{\n  -webkit-transition:opacity linear 500ms;\n  transition:opacity linear 500ms; }\n.carousel-3d-controls{\n  position:absolute;\n  top:30%;\n  left:0;\n  width:100%;\n  z-index:9099; }\n.carousel-3d-next,\n.carousel-3d-prev{\n  width:60px;\n  position:absolute !important;\n  z-index:9999; }\n.carousel-3d-next:hover,\n.carousel-3d-prev:hover{\n  cursor:pointer; }\n.carousel-3d-next{\n  left:0; }\n.carousel-3d-prev{\n  right:0; }\n.arrow-top,\n.arrow-right,\n.arrow-bottom,\n.arrow-left{\n  display:block;\n  margin:20px auto;\n  overflow:hidden;\n  position:relative; }\n.arrow-top,\n.arrow-bottom{\n  height:34px;\n  width:64px; }\n.arrow-right,\n.arrow-left{\n  height:64px;\n  width:34px; }\n.arrow-top:before,\n.arrow-right:before,\n.arrow-bottom:before,\n.arrow-left:before{\n  border:30px solid transparent;\n  content:' ';\n  display:block;\n  position:absolute;\n  z-index:2; }\n.arrow-top:before{\n  border-bottom-color:#000000;\n  left:2px;\n  bottom:0; }\n.arrow-right:before{\n  border-left-color:#000000;\n  left:0;\n  top:2px; }\n.arrow-bottom:before{\n  border-top-color:#000000;\n  left:2px;\n  top:0; }\n.arrow-left:before{\n  border-right-color:#000000;\n  right:0;\n  top:2px; }\n.arrow-top-bg:after,\n.arrow-right-bg:after,\n.arrow-bottom-bg:after,\n.arrow-left-bg:after{\n  border:32px solid transparent;\n  content:' ';\n  display:block;\n  position:absolute;\n  z-index:1; }\n.arrow-top-bg:after{\n  border-bottom-color:#000000;\n  bottom:0;\n  left:0; }\n.arrow-right-bg:after{\n  border-left-color:#000000;\n  left:0;\n  top:0; }\n.arrow-bottom-bg:after{\n  border-top-color:#000000;\n  left:0;\n  top:0; }\n.arrow-left-bg:after{\n  border-right-color:#000000;\n  right:0;\n  top:0; }\n@-webkit-keyframes uil-rolling-anim{\n  0%{\n    -webkit-transform:rotate(0deg);\n    transform:rotate(0deg); }\n  50%{\n    -webkit-transform:rotate(180deg);\n    transform:rotate(180deg); }\n  100%{\n    -webkit-transform:rotate(360deg);\n    transform:rotate(360deg); } }\n@-webkit-keyframes uil-rolling-anim{\n  0%{\n    -webkit-transform:rotate(0deg);\n    transform:rotate(0deg); }\n  50%{\n    -webkit-transform:rotate(180deg);\n    transform:rotate(180deg); }\n  100%{\n    -webkit-transform:rotate(360deg);\n    transform:rotate(360deg); } }\n@-webkit-keyframes uil-rolling-anim{\n  0%{\n    -webkit-transform:rotate(0deg);\n    transform:rotate(0deg); }\n  50%{\n    -webkit-transform:rotate(180deg);\n    transform:rotate(180deg); }\n  100%{\n    -webkit-transform:rotate(360deg);\n    transform:rotate(360deg); } }\n@keyframes uil-rolling-anim{\n  0%{\n    -webkit-transform:rotate(0deg);\n    transform:rotate(0deg); }\n  50%{\n    -webkit-transform:rotate(180deg);\n    transform:rotate(180deg); }\n  100%{\n    -webkit-transform:rotate(360deg);\n    transform:rotate(360deg); } }\n.carousel-3d-loader-circle{\n  border:16px solid #d9d9d9;\n  border-top:16px solid #209e91;\n  border-radius:50%;\n  width:120px;\n  height:120px;\n  -webkit-animation:spin 2s linear infinite;\n          animation:spin 2s linear infinite; }\n.carousel-3d-loader-circle > div{\n  width:100px;\n  height:100px;\n  position:relative;\n  -webkit-animation:uil-rolling-anim 1s linear infinite;\n  animation:uil-rolling-anim 1s linear infinite; }\n.carousel-3d-loader-circle > div div{\n  position:absolute;\n  width:100px;\n  height:50px;\n  border-radius:500px 500px 0 0;\n  border-color:#000000;\n  border-style:solid;\n  border-width:20px;\n  border-bottom-width:0; }\n.carousel-3d-loader-circle > div div:nth-of-type(2){\n  -webkit-transform:translate(0, 25px) rotate(27deg) translate(0, -25px);\n  transform:translate(0, 25px) rotate(27deg) translate(0, -25px); }\n.carousel-3d-loader{\n  position:relative;\n  left:46%; }\n.carousel-3d-loader-percentage,\n.carousel-3d-loader-error{\n  font-size:18px;\n  position:absolute;\n  top:50%;\n  text-align:center;\n  left:3.2%;\n  margin-top:-9px;\n  line-height:18px; }\n"],providers:[]}]}],u.ctorParameters=function(){return[]},u.propDecorators={options:[{type:r.Input}],slides:[{type:r.Input}],onBeforeChange:[{type:r.Input}],onLastSlide:[{type:r.Input}],onSlideChange:[{type:r.Input}],onSelectedClick:[{type:r.Input}]};var h=function(){function t(){}return t.prototype.ngOnInit=function(){},t}();h.decorators=[{type:r.Component,args:[{selector:"ngx-carousel-3d-slide",template:'<div class="slide-3d">\n      <ng-content></ng-content>\n</div>\n',styles:[".slide-3d{\n  border-radius:4px;\n  border-color:#000;\n  border-color:rgba(0, 0, 0, 0.4);\n  border-style:solid;\n  background-size:cover;\n  height:100%; }\n.slide-3d figure img{\n  width:100%; }\n.slide-3d figure figcaption{\n  position:absolute;\n  background:rgba(0, 0, 0, 0.5);\n  color:#fff;\n  width:100%;\n  left:0;\n  bottom:0;\n  font-weight:normal;\n  text-align:center;\n  padding:7px 10px; }\n"]}]}],h.ctorParameters=function(){return[]};var p=function(){};p.decorators=[{type:r.NgModule,args:[{imports:[s.CommonModule],declarations:[u,h],exports:[u,h]}]}],p.ctorParameters=function(){return[]},t.NgxCarousel3dModule=p,t.ɵb=h,t.ɵa=u,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-carousel-3d.umd.min.js.map
